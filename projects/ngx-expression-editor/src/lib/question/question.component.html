<div class="form-inline question">
  <div class="question-select">
    <input [style]="lhcStyle.input" placeholder="Select" class="query-autocomplete"
      #autoComplete id="question-{{index}}"

      [attr.aria-invalid]="question.invalid"
      [attr.aria-label]="question?.errors?.ariaMessage"
      [class.field-error]="question.errors"
      (ngModel)="variable.expression"
      #question="ngModel"
      lhcExpressionValidator
      [lhcExpressionValidateInput]="'true'"
           [lhcExpressionValidatorParams]="{'section': 'Item Variables',
                                            'field': 'expression', 'type': 'question',
                                            'linkId': linkId, 'index': index}"
      />
  </div>

  <div class="unit-select">
    @if (conversionOptions) {
      <select [(ngModel)]="toUnit" [style]="lhcStyle.select"
        (change)="onChange(false)" aria-label="Unit conversion">
        <option value="">Keep form units ({{unit}})</option>
        @for (u of conversionOptions; track u) {
          <option value="{{u.unit}}">Convert to {{u.unit}}</option>
        }
      </select>
    }

    @if (isNonConvertibleUnit) {
      <div class="detail">Unit: {{unit}}</div>
    }
    @if (itemHasScore) {
      <div class="detail">Score</div>
    }
  </div>
</div>
@if (!question.errors) {
  <lhc-syntax-preview [syntax]="expression" [lhcStyle]="lhcStyle"></lhc-syntax-preview>
}
<div id="expression-error" role="alert" class="row error-span">
  @if (question.errors) {
    <p class="expression-error">
      {{question.errors.message}}
    </p>
  }
</div>