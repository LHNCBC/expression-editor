<h2>Variables</h2>

<div class="container">
  <div class="row font-weight-bold mb-2" aria-hidden="true">
    <div class="col-md-2">Label</div>
    <div class="col-md-3">Type</div>
    <div class="col-md-7">Question/FHIRPath Expression</div>
  </div>
  <div cdkDropListGroup>
    <div *ngFor="let level of levels" cdkDropList [cdkDropListData]="0" (cdkDropListDropped)="drop($event)">
<!--      <h3>{{level.name}}</h3>-->
      <div class="drag-variable row py-2" *ngFor="let variable of variables; index as i" cdkDrag>
        <div class="col-md-2 form-inline">
          <img alt="Drag Handle" width="20" height="20" class="mr-2 handle" src="assets/grip-vertical.svg" cdkDragHandle />
          <input [id]="'variable-label-' + i" [(ngModel)]="variable.label" class="form-control w-75" aria-label="Variable label" />
        </div>
        <div class="col-md-3">
          <div class="form-inline">
            <select [id]="'variable-type-' + i" class="form-control" [(ngModel)]="variable.type" aria-label="Variable type">
              <option value="" disabled hidden>Select...</option>
              <option *ngFor="let type of variableType | keyvalue" value="{{type.key}}">{{type.value}}</option>
            </select>
          </div>
        </div>
        <div class="col-md-6" [ngSwitch]="variable.type">
          <app-question [variable]="variable" [advancedInterface]="advancedInterface" *ngSwitchCase="'question'"></app-question>
          <div class="form-inline" *ngSwitchCase="'expression'">
            <input [id]="'variable-expression-' + i" [(ngModel)]="variable.expression" class="form-control mr-2 w-100"
                   aria-label="Expression" />
          </div>
        </div>
        <div class="col-md-1">
          <button class="btn btn-danger" aria-label="Remove Line" (click)="onRemove(i)">x</button>
        </div>
      </div>
      <div *ngIf="!variables.length" class="py-2">No variables, please <a href="#" (click)="onAdd()">add one</a>.</div>
    </div>
  </div>
</div>

<button class="btn btn-secondary mt-2" (click)="onAdd()">Add variable</button>

<pre *ngIf="showFhirPath">
  {{variables|json}}
</pre>
